"use strict";function renderNode(e){"string"==typeof e?idom.text(e):Array.isArray(e)?e.forEach(renderNode):e()}function renderDomElement(e,t,n){var a=null!==t?t.key:void 0,r=void 0!==a?a.toString():a;idom.elementOpenStart(e,r),null!==t&&Object.keys(t).forEach(function(e){"key"!==e&&idom.attr(e,t[e])}),idom.elementOpenEnd(),n.forEach(renderNode),idom.elementClose(e)}function createElement(e,t){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];return"string"==typeof e?function(){renderDomElement(e,t,n)}:e(t,n)}function empty(){}function toRecord(e,t){return e[t.id]=t.fields,e}function setItem(e,t){localStorage.setItem(e,t),render()}function fetchTable(e){var t=token();return null===t?Promise.reject("Unauthenticated"):fetch(BASE+"/"+e,{headers:{Authorization:"Bearer "+t}}).then(function(e){return e.json().then(function(t){if(!e.ok)throw new Error(t.error.message);return t.records.reduce(function(e,t){return e[t.id]=t.fields,e},{})})})}function upgrade(){applicationCache.swapCache(),location.reload(!0)}function authenticate(e){e.preventDefault();var t=e.currentTarget,n=t.querySelector("input");n&&setItem(TOKEN_KEY,n.value)}function onError(e){ERR=e.message,render()}function fetchData(){Promise.all([fetchTable("Abilities"),fetchTable("Advancement"),fetchTable("Armor"),fetchTable("Attacks"),fetchTable("Characters"),fetchTable("Cyphers"),fetchTable("Effects"),fetchTable("Equipment"),fetchTable("Skills"),fetchTable("Stats")]).then(function(e){var t={Abilities:e[0],Advancements:e[1],Armor:e[2],Attacks:e[3],Characters:e[4],Cyphers:e[5],Effects:e[6],Equipment:e[7],Skills:e[8],Stats:e[9]};setItem(DATA_KEY,JSON.stringify(t))}).catch(onError)}function token(){return localStorage.getItem(TOKEN_KEY)}function data(){var e=localStorage.getItem(DATA_KEY);return null===e?e:JSON.parse(e)}function statSortKey(e){switch(e){case"Might":return 0;case"Speed":return 1;case"Intellect":return 2;default:return 3}}function effectSortKey(e){switch(e){case"Minor":return 0;case"Major":return 1;default:return 2}}function patch(){idom.patch(document.body,createElement(App,null))}function render(){window.requestAnimationFrame(patch)}var __assign=this&&this.__assign||Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},idom=IncrementalDOM,DESCRIPTORS=["Appealing","Brash","Calm","Charming","Clever","Clumsy","Craven","Creative","Cruel","Dishonorable","Doomed","Driven","Empathic","Exiled","Fast","Foolish","Graceful","Guarded","Hardy","Hideous","Honorable","Impulsive","Inquisitive","Intelligent","Jovial","Kind","Learned","Lucky","Mad","Mechanical","Mysterious","Mystical","Naive","Noble","Perceptive","Resilient","Rugged","Sharp-Eyed","Skeptical","Spiritual","Stealthy","Strong","Strong-Willed","Swift","Tongue-Tied","Tough","Vengeful","Virtuous","Wealthy","Weird"],FLAVORS=["Stealth","Technology","Combat","Skills and Knowledge"],TYPES=["Warrior","Adept","Explorer","Speaker"],FOCI=["Abides in Stone","Battles Robots","Bears a Halo of Fire","Blazes with Radiance","Builds Robots","Calculates the Incalculable","Carries a Quiver","Commands Mental Powers","Conducts Weird Science","Consorts With the Dead","Controls Gravity","Crafts Unique Objects","Defends the Weak","Doesn't Do Much","Employs Magnetism","Entertains","Exists Partially Out of Phase","Exists in Two Places at Once","Explores Dark Places","Explores Deep Waters","Fights Dirty","Fights With Panache","Focuses Mind Over Matter","Fuses Flesh and Steel","Fuses Mind and Machine","Grows to Towering Heights","Hunts With Great Skill","Infiltrates","Interprets the Law","Is Idolized by Millions","Is Licensed to Carry","Leads","Lives in the Wilderness","Looks for Trouble","Masters Defense","Masters Weaponry","Masters the Swarm","Metes Out Justice","Moves Like a Cat","Moves Like the Wind","Murders","Needs No Weapon","Never Says Die","Operates Undercover","Performs Feats of Strength","Rages","Rides the Lightning","Sees Beyond","Separates Mind From Body","Siphons Power","Slays Monster","Solves Mysteries","Stands Like a Bastion","Talks to Machines","Throws With Deadly Accuracy","Travels Through Time","Wears a Sheen of Ice","Wields Two Weapons at Once","Works the Back Alleys","Works the System","Would Rather Be Reading"],ATTACK_TYPE=["Melee","Ranged"],ATTACK_DISTINCTION=["Crushing","Reaching","Slashing","Stabbing"],ARMOR_CATEGORY=["Light","Medium","Heavy"],SKILL_LEVEL=["Inability","Trained","Specialized"],ABILITY_TYPE=["Action","Enabler"],STATS=["Might","Speed","Intellect"],BASE="https://api.airtable.com/v0/app3twwgtlOjlzeLy",DATA_KEY="$data",TOKEN_KEY="$token",ERR=null,Row=function(e,t){return createElement("div",{class:"row"},t)},Cell=function(e,t){return createElement("div",{class:"cell"+(null!==e&&e.content?" content":"")},t)},Label=function(e){var t=e.name;return createElement("label",{for:t},t)},TextField=function(e){var t=e.name,n=e.type?e:__assign({type:"text"},e);return createElement(Cell,{content:e.content},createElement("input",__assign({name:t},n)),createElement(Label,{name:e.label||t}))},Select=function(e){var t=e.name,n=e.options,a=e.value,r=e.content;return createElement(Cell,{content:r},createElement("select",{class:a,name:t},a?empty:createElement("option",{selected:!0}),n.map(function(e,t){var n=t.toString(16),r=e===a;return r?createElement("option",{key:n,value:e,selected:r},e):createElement("option",{key:n,value:e},e)})),createElement(Label,{name:t}))},TextArea=function(e){var t=e.name,n=e.value;return createElement(Cell,null,createElement("textarea",{name:t},n||""),createElement(Label,{name:t}))},AppBar=function(){return createElement("header",null,createElement("a",{class:"title",href:"#"},"Overcast"))},Upgrade=function(){return createElement("main",{class:"upgrade",onclick:upgrade},createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},createElement("path",{d:"M17 1.01L7 1c-1.1 0-2 .9-2 2v18c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2V3c0-1.1-.9-1.99-2-1.99zM17 19H7V5h10v14zm-1-6h-3V8h-2v5H8l4 4 4-4z"})),createElement("p",null,"Upgrade Available"))},Login=function(){return createElement("form",{onsubmit:authenticate},createElement("fieldset",null,createElement(Row,null,createElement(TextField,{name:"Token",type:"password",required:!0,inputMode:"verbatim",autofocus:!0})),createElement(Row,null,createElement(Cell,null,createElement("button",{type:"submit"},"Authenticate")))))},Loading=function(){return createElement("main",{class:"loading"},createElement("div",{class:"spinner"}))},Err=function(){return createElement("main",{class:"error"},createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"48",height:"48",viewBox:"0 0 48 48"},createElement("path",{d:"M24 4C12.96 4 4 12.95 4 24s8.96 20 20 20 20-8.95 20-20S35.04 4 24 4zm2 30h-4v-4h4v4zm0-8h-4V14h4v12z"})),createElement("p",null,ERR))},List=function(e){var t=e.store,n=t.Characters;return createElement("main",{class:"list"},Object.keys(n).map(function(e){return createElement("a",{class:"item",href:"#"+e},n[e].Name)}))},Overview=function(e){var t=e.character;return createElement("fieldset",null,createElement("legend",null,"Overview"),createElement(Row,null,createElement(TextField,{name:"Name",value:t.Name})),createElement(Row,null,createElement(Select,{name:"Descriptor",value:t.Descriptor,options:DESCRIPTORS})),createElement(Row,null,createElement(Select,{name:"Flavor",value:t.Flavor,options:FLAVORS}),createElement(Select,{name:"Type",value:t.Type,options:TYPES})),createElement(Row,null,createElement(Select,{name:"Focus",value:t.Focus,options:FOCI})))},Summary=function(e){var t=e.character;return createElement("fieldset",null,createElement("legend",null,"Summary"),createElement(Row,null,createElement(TextField,{name:"Effort",value:t.Effort,type:"number",min:"0"}),createElement(TextField,{name:"Limit",value:t.Limit,type:"number",min:"0"}),createElement(TextField,{name:"XP",value:t.XP,type:"number",min:"0"})))},Stat=function(e){var t=e.stat;return createElement("div",{class:"column"},createElement(Row,null,createElement(TextField,{name:"Value",label:t.Stat,value:t.Value,type:"number",min:"0",max:t.Pool})),createElement(Row,null,createElement(TextField,{name:"Pool",value:t.Pool,type:"number",min:"0"}),createElement(TextField,{name:"Edge",value:t.Edge,type:"number",min:"0"})))},Stats=function(e){var t=e.character,n=e.store,a=t.Stats.sort(function(e,t){return statSortKey(n.Stats[e].Stat)-statSortKey(n.Stats[t].Stat)});return createElement("fieldset",null,createElement("legend",null,"Stats"),createElement(Row,null,a.map(function(e){return createElement(Stat,{stat:n.Stats[e]})})))},Effect=function(e){var t=e.effect;return createElement(Row,null,createElement(TextField,{name:"Level",value:t.Level,content:!0}),createElement(TextArea,{name:"Notes",value:t.Notes}))},Flavor=function(e){var t=e.character,n=e.store,a=t.Effects.sort(function(e,t){return effectSortKey(n.Effects[e].Level)-effectSortKey(n.Effects[t].Level)});return createElement("fieldset",null,createElement("legend",null,"Flavor"),createElement(Row,null,createElement(TextArea,{name:"Notes",value:t.Notes})),a.map(function(e){return createElement(Effect,{effect:n.Effects[e]})}))},Attack=function(e){var t=e.attack;return createElement(Row,null,createElement(TextField,{name:"Name",value:t.Name}),createElement(TextField,{name:"Damage",value:t.Damage,type:"number",min:"0",content:!0}),createElement(Select,{name:"Type",value:t.Type,options:ATTACK_TYPE,content:!0}),createElement(Select,{name:"Distinction",value:t.Distinction,options:ATTACK_DISTINCTION,content:!0}))},Attacks=function(e){var t=e.character,n=e.store;return createElement("fieldset",null,createElement("legend",null,"Attacks"),t.Attacks.map(function(e){return createElement(Attack,{attack:n.Attacks[e]})}))},Armor=function(e){var t=e.armor;return createElement(Row,null,createElement(TextField,{name:"Name",value:t.Name}),createElement(Select,{name:"Category",value:t.Category,options:ARMOR_CATEGORY,content:!0}),createElement(TextField,{name:"Bonus",value:t.Bonus,type:"number",disabled:!0,content:!0}))},Armors=function(e){var t=e.character,n=e.store;return createElement("fieldset",null,createElement("legend",null,"Armor"),t.Armor.map(function(e){return createElement(Armor,{armor:n.Armor[e]})}))},Equipment=function(e){var t=e.equipment;return createElement(Row,null,createElement(TextField,{name:"Name",value:t.Name}),createElement(TextArea,{name:"Notes",value:t.Notes}))},Equipments=function(e){var t=e.character,n=e.store;return createElement("fieldset",null,createElement("legend",null,"Equipment"),t.Equipment.map(function(e){return createElement(Equipment,{equipment:n.Equipment[e]})}))},Skill=function(e){var t=e.skill;return createElement(Row,null,createElement(TextField,{name:"Name",value:t.Name}),createElement(Select,{name:"Level",value:t.Level,options:SKILL_LEVEL,content:!0}))},Skills=function(e){var t=e.character,n=e.store;return createElement("fieldset",null,createElement("legend",null,"Skills"),t.Skills.map(function(e){return createElement(Skill,{skill:n.Skills[e]})}))},Ability=function(e){var t=e.ability;return createElement(Row,null,createElement(TextField,{name:"Name",value:t.Name}),createElement(Select,{name:"Type",value:t.Type,options:ABILITY_TYPE,content:!0}),createElement(Select,{name:"Stat",value:t.Stat,options:STATS,content:!0}),createElement(TextField,{name:"Cost",value:t.Cost,type:"number",content:!0}),createElement(TextArea,{name:"Notes",value:t.Notes}))},Abilities=function(e){var t=e.character,n=e.store;return createElement("fieldset",null,createElement("legend",null,"Abilities"),t.Abilities.map(function(e){return createElement(Ability,{ability:n.Abilities[e]})}))},Cypher=function(e){var t=e.cypher;return createElement(Row,null,createElement(TextField,{name:"Name",value:t.Name}),createElement(TextField,{name:"Level",value:t.Level,type:"number",content:!0}),createElement(TextArea,{name:"Effect",value:t.Effect}))},Cyphers=function(e){var t=e.character,n=e.store;return createElement("fieldset",null,createElement("legend",null,"Cyphers"),t.Cyphers.map(function(e){return createElement(Cypher,{cypher:n.Cyphers[e]})}))},Maybe=function(e){return e.ids&&e.ids.length>0?createElement(e.factory,{character:e.character,store:e.store}):empty},Character=function(e){var t=e.id,n=e.store,a=n.Characters[t];return createElement("main",{class:"character"},createElement("section",null,createElement(Overview,{character:a}),createElement(Summary,{character:a}),createElement(Stats,{character:a,store:n}),createElement(Flavor,{character:a,store:n})),createElement("section",null,createElement(Maybe,{ids:a.Attacks,factory:Attacks,character:a,store:n}),createElement(Maybe,{ids:a.Armor,factory:Armors,character:a,store:n}),createElement(Maybe,{ids:a.Equipment,factory:Equipments,character:a,store:n})),createElement("section",null,createElement(Maybe,{ids:a.Abilities,factory:Abilities,character:a,store:n}),createElement(Maybe,{ids:a.Skills,factory:Skills,character:a,store:n}),createElement(Maybe,{ids:a.Cyphers,factory:Cyphers,character:a,store:n})))},Main=function(){if(applicationCache.status===applicationCache.UPDATEREADY)return createElement(Upgrade,null);if(null===token())return createElement(Login,null);var e=data();if(null===e)return createElement(Loading,null);if(null!==ERR)return createElement(Err,null);var t=location.hash.substr(1);return 0===t.length?createElement(List,{store:e}):createElement(Character,{id:t,store:e})},App=function(){return createElement("div",{class:"app"},createElement(AppBar,null),createElement(Main,null))};window.addEventListener("load",render),window.addEventListener("load",fetchData),applicationCache.addEventListener("updateready",render),window.addEventListener("hashchange",render),window.addEventListener("storage",render);
//# sourceMappingURL=dist/b063624c686535995d721a70.map